!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("leancloud-storage"),require("leancloud-realtime")):"function"==typeof define&&define.amd?define("typed-messages",["exports","leancloud-storage","leancloud-realtime"],t):t((e=e||self).AV=e.AV||{},e.AV,e.AV)}(this,(function(e,t,r){"use strict";var n=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};var i=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t};if(!t.File)throw new Error("LeanCloud Storage SDK not installed");if(!r.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(e){function n(r){var n;if(!(r instanceof t.File))throw new TypeError("file must be an AV.File");if("string"!=typeof r.id)throw new Error("file must be saved before used to create a Message");return(n=e.call(this)||this)._file=r,n._lcfile={objId:r.id,url:r.url(),metaData:Object.assign(r.metaData()||{},{name:r.name()})},n}i(n,e);var o=n.prototype;return o.getFile=function(){return this._file},o.toJSON=function(){return u(u({},e.prototype.toJSON.call(this)),{},{file:this.getFile().toJSON()})},n._parseFileFromRawData=function(e){if(!e||!e._lcfile)throw new Error("malformed FileMessage content");var r=e._lcfile.objId;"string"!=typeof r&&(r="");var n=t.File.createWithoutData(r);return n.attributes=n.attributes||{},n._url=e._lcfile.url,n.attributes.url=n._url,n._metaData=e._lcfile.metaData||{},n.attributes.metaData=n._metaData,e._lcfile.metaData&&(n._name=e._lcfile.metaData.name,n.attributes.name=n._name),n},n.parse=function(e,t){var n=this._parseFileFromRawData(e);return r.TypedMessage.parse(e,t||new this(n))},a(n,[{key:"summary",get:function(){return"[".concat(this.constructor._summaryType,"] ").concat(this._file.name()||"").trim()}}]),n}(r.TypedMessage);l._summaryType="文件",r.messageType(-6)(l),r.messageField("_lcfile")(l),r.IE10Compatible(l);var c=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l);c._summaryType="图片",r.messageType(-2)(c),r.IE10Compatible(c);var p=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l);p._summaryType="语音",r.messageType(-3)(p),r.IE10Compatible(p);var f=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}f._summaryType="视频",r.messageType(-4)(f),r.IE10Compatible(f);var g=function(e){function n(r){var n;if(!(r instanceof t.GeoPoint))throw new TypeError("geoPoint must be an AV.GeoPoint");(n=e.call(this)||this)._geoPoint=r;var o=r.latitude,a=r.longitude;return n._lcloc={latitude:o,longitude:a},n}i(n,e);var o=n.prototype;return o.getLocation=function(){return this._geoPoint},o.toJSON=function(){return m(m({},e.prototype.toJSON.call(this)),{},{location:this.getLocation().toJSON()})},n.parse=function(e,n){var o=e._lcloc,a=o.latitude,i=o.longitude,s=new t.GeoPoint({latitude:a,longitude:i});return r.TypedMessage.parse(e,n||new this(s))},a(n,[{key:"summary",get:function(){return"[位置] ".concat(this.text||"").trim()}}]),n}(r.TypedMessage);r.messageType(-5)(g),r.messageField("_lcloc")(g),r.IE10Compatible(g);var b={name:"leancloud-realtime-plugin-typed-messages",messageClasses:[l,c,p,f,g]};e.AudioMessage=p,e.FileMessage=l,e.ImageMessage=c,e.LocationMessage=g,e.TypedMessagesPlugin=b,e.VideoMessage=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=typed-messages.min.js.map
